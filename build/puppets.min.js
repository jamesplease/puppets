// Puppets v0.0.1

!function(a,b){if("function"==typeof define&&define.amd)define(["backbone","underscore"],function(a,c){return b(a,c)});else if("undefined"!=typeof exports){var c=require("backbone"),d=require("underscore");module.exports=b(c,d)}else b(a.Backbone,a._)}(this,function(a,b){"use strict";var c=a.Puppets(),d=a.Puppets={};d.VERSION="0.0.1",d.noConflict=function(){return a.Puppets=c,this},d.extend=a.Model.extend,d.$=a.$,d.mergeOptions=function(a,c,d){c&&b.extend(a,b.pick(c,d))},d.templateOptions={},d.compileTemplate=function(a,c){return b.template(a,b.extend(d.templateOptions,c))},d.renderTemplate=function(a,b){return a(b)},d.listenToObject=function(a,b){d._listenToApi(a,b,"listenTo")},d.stopListeningToObject=function(a,b){d._listenToApi(a,b,"stopListening")},d._listenToApi=function(a,c,d){a&&c&&b.each(c,function(c,e){b.isFunction(c)||(c=this[c]),this[d](a,e,c)},this)},d.Application=function(){this.cid=b.uniqueId("c"),this.initialize.apply(this,arguments)},b.extend(d.Application.prototype,{start:function(){this.trigger.apply(this,"start",arguments)},stop:function(){this.trigger.apply(this,"stop",arguments)}},a.Events),d.Application.extend=d.extend,d.Animate=function(){},b.extend(d.Animate,{addAnimation:function(){}});var e=function(a){d.mergeOptions(this,a,this.regionOptions),this.cid=b.uniqueId("r"),this.selector=a.selector,this._setView(a.view,a.viewOptions)};b.extend(e.prototype,{regionOptions:["view","viewOptions","el","selector"],currentView:function(){return this._view},cloneTree:function(){if(this._view){var a=this._view.$el.clone();return this._updateEl(a),a}},_updateEl:function(a){this.el=a,this._view&&(this._view.setElement(a),this._view._updateRegions())},show:function(a,b){b=b||{},this._view instanceof a&&!b.force||(this._disposeView(),this._setView(a,b))},_setView:function(a,b){a&&(this._view=this._createView(a,b),this._view._parent=this,this._view.render())},_createView:function(a,c){return new a(b.extend({},c,{el:this.el}))},_disposeView:function(){var a=this.currentView();a&&a.dispose()}},a.Events),e.extend=d.extend,d.Region=e;var f=a.View.extend({abstractViewOptions:["model","collection","modelEvents","collectionEvents","template"],constructor:function(b){d.mergeOptions(this,b,this.abstractViewOptions),this.listenToModel(),this.listenToCollection(),a.View.prototype.constructor.apply(this,arguments)},setModel:function(a){this.stopListeningToModel(),this.model=a,this.listenToModel()},setCollection:function(a){this.stopListeningToCollection(),this.collection=a,this.listenToModel(a)},listenToModel:function(){d.listenToObject(this.model,b.result(this,"modelEvents"))},stopListeningToModel:function(){d.stopListeningToObject(this.model,b.result(this,"modelEvents"))},listenToCollection:function(){d.listenToObject(this.model,b.result(this,"modelEvents"))},stopListeningToCollection:function(){d.stopListeningToObject(this.collection,b.result(this,"collectionEvents"))},remove:function(){return this.trigger("before:remove",this),a.View.prototype.remove.apply(this,arguments),this.trigger("remove",this),this},dispose:function(){return this.trigger("before:dispose",this),this.stopListening(),delete this._parent,this.trigger("dispose",this),this}});d.AbstractView=f;var g=f.extend({viewOptions:["childViews"],region:d.Region,constructor:function(a){d.mergeOptions(this,a,this.viewOptions),this._regions={},f.prototype.constructor.apply(this,arguments),!this.template&&this.childViews&&this._addRegions(this.childViews)},render:function(a){this.trigger("before:render",this,a);var c="<div>"+d.renderTemplate(this.template)+"</div>",e=d.$($.parseHTML(c));return b.isEmpty(this._regions)&&this.childViews?this._addRegions(this.childViews,e):b.each(this._regions,function(a){e.find(a.selector).replaceWith(a.cloneTree())},this),this.$el.empty().append(e.contents()),this.trigger("render",this,a),this},showChildView:function(a,b,c){var d=this._getRegion(a);return d||this._throwRegionError(),d.show(b,c),this},getChildView:function(a){return this._getRegion(a).currentView()},_getRegion:function(a){var b=this._regions[a];return b?b:this._addRegion(a)},_addRegion:function(a,c,d){if(d=d||this.$el,!this._regions[a]){var e=d.find(a);e||this._throwRegionError(a);var f=b.isFunction(c),g={selector:a,el:e,view:f?c:c.view,viewOptions:f?{}:c.options},h=this._createRegion(g);return h._parent=this,this._regions[a]=h,this}},_addRegions:function(a,c){return b.each(a,function(a,b){this._addRegion(b,a,c)},this),this},_createRegion:function(a){return new this.region(a)},_updateRegions:function(){b.each(this._regions,function(a){a._updateEl(this.$el.find(a.selector))},this)},_throwRegionError:function(a){throw new Error('The selector "'+a+'" must exist to create a region.')}});d.View=g;var h=f.extend({});return d.CollectionView=h,d});
//# sourceMappingURL=puppets.min.js.map